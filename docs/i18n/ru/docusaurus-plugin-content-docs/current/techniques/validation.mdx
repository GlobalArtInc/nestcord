---
id: валидация
title: Проверка
sidebar_position: 0
---

`ValidationPipe` является встроенным пунктом, который может быть использован для проверки данных, поступающих от клиента. Он использует пакет [class-validator](https://github.com/typestack/class-validator) под капюшоном. `ValidationPipe` предоставляет удобный подход к соблюдению правил проверки для всех входящих клиентских загрузок, где конкретные правила объявлены простыми аннотациями в декларациях DTO в каждом модуле.

## Установка

```bash npm2yarn
$ npm установить класс-валидатор класс-трансформатор
```

## Использование

Теперь мы можем добавить несколько правил проверки в наш `CreateUserDto`. We do this using decorators provided by the class-validator package, described in detail [here](https://github.com/typestack/class-validator#validation-decorators). Таким образом, любой маршрут, использующий `CreateUserDto` будет автоматически приводить в исполнение эти правила проверки.

```typescript title="src/users/dto/create-user.dto.ts"
импортировать { IsNotEmpty, IsString, IsEmail } из 'class-validator';

export class CreateUserDto {
    @StringOption({
        name: 'name',
        description: 'Your name',
        required: true
    })
    имя: строка;

    @IsEmail()
    @StringOption({
        name: 'text',
        description: 'Your email',
        required: false
    })
    email: string;
}
```

:::tip
Also you can use `ValidationPipe` for transforming and validating the payload of a request.

[Подробнее о преобразовании](https://docs.nestjs.com/techniques/validation#transform-payload-objects)
:::

Теперь мы можем использовать `ValidationPipe` в нашем `UsersCommands` для применения правил проверки, которые мы только что определили.

```typescript title="src/users/users.commands.ts"
import { Injectable } from '@nestjs/common';
import { Context, SlashCommand, SlashCommandContext } from '@globalart/nestcord';

@Injectable()
export class UsersCommands {
    @SlashCommand({
        name: 'create',
        description: 'Create a new user'
    })
    public async onCreateUser(
        @Context() [interaction]: SlashCommandContext,
        @Options(new ValidationPipe({ validateCustomDecorators: true })) createUserDto: CreateUserDto
    ) {
        return interaction. eply({ content: `User created: ${createUserDto.name}` });
    }
}
```

Теперь, если мы попытаемся использовать команду `create` без указания имени или электронной почты, мы получим сообщение об ошибке.

```bash
{"statusCode":400,"message":["email не должен быть пустым"],"error":"Некорректный запрос"}
```

Вы можете создать сниппет для проверенных декораторов опций:

```typescript title="src/decorators/validated-options.decorator.ts"
import { ValidationPipe, PipeTransform } from '@nestjs/common';

export const ValidatedOptions = (...dataOrPipes: PipeTransform[] | string) => {
    return Options(...dataOrPipes, new ValidationPipe());
};
```

:::tip
You can create filters to handle and response validation errors.

[Смотрите фильтры исключений для получения дополнительной информации](https://docs.nestjs.com/exception-filters#exception-filters)
:::
